function playTrackWithTransition(index) {
    if (currentTrackIndex !== null) {
        fadeOut(() => {
            playTrack(index);
            fadeIn(); // Fade in the new track
        });
    } else {
        playTrack(index);
        fadeIn(); // Fade in the new track if nothing is playing
    }
}

function fadeOut(callback) {
    const fadeInterval = setInterval(() => {
        if (audioPlayer.volume > 0) {
            audioPlayer.volume -= 0.1; // Decrease volume
        } else {
            clearInterval(fadeInterval);
            audioPlayer.pause(); // Pause the track after fading out
            audioPlayer.volume = 1; // Reset volume for next play
            if (callback) callback(); // Execute the callback
        }
    }, 100); // Adjust the speed of fade out
}

function fadeIn() {
    audioPlayer.volume = 0; // Start from volume 0
    audioPlayer.play(); // Start playing
    const fadeInterval = setInterval(() => {
        if (audioPlayer.volume < 1) {
            audioPlayer.volume += 0.1; // Increase volume
        } else {
            clearInterval(fadeInterval); // Stop when fully faded in
        }
    }, 100); // Adjust the speed of fade in
}
